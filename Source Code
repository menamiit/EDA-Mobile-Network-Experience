import pandas as pd
import numpy as np

# Importing the Excel file
df = pd.read_excel('C:/Users/Acer/Downloads/Python Project/rawData.xlsx')


# Dataset Summary
print(df.info())
print(df.describe())

# Make a working copy of the original data
df_clean = df.copy()

# Step 1: Replace placeholder values in latitude and longitude
df_clean[['latitude', 'longitude']] = df_clean[['latitude', 'longitude']].replace(-1.0, np.nan)

# Missing values count before cleaning
print("\nMissing values before cleaning:")
print(df_clean.isnull().sum())

# Dropped rows where both latitude and longitude are missing (they're not useful)
df_clean = df_clean[~(df_clean['latitude'].isna() & df_clean['longitude'].isna())]

# Dropped rows where state_name is missing
# Here we drop them since we can't impute them reliably without geo lookup
df_clean = df_clean[df_clean['state_name'].notna()]

# Strip whitespace and standardize case in string columns
str_cols = ['inout_travelling', 'operator', 'network_type', 'calldrop_category', 'state_name']
for col in str_cols:
    df_clean[col] = df_clean[col].str.strip().str.title()

# Final missing values check after cleaning
print("\nMissing values after cleaning:")
print(df_clean.isnull().sum())

# Cleaned data preview
print("\nCleaned DataFrame preview:")
print(df_clean.head())
